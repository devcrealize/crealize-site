<!DOCTYPE html>
<html>
<head>
    <title>Formspree Debug Tool</title>
    <style>
        body { font-family: Arial; max-width: 900px; margin: 50px auto; padding: 20px; }
        .test-section { border: 1px solid #ddd; margin: 20px 0; padding: 20px; border-radius: 5px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, textarea, select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 3px; }
        button { background: #007cba; color: white; padding: 10px 20px; border: none; border-radius: 3px; cursor: pointer; margin: 5px; }
        button:hover { background: #005a87; }
        .error { color: red; }
        .success { color: green; }
        .warning { color: orange; }
        .info { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 3px; }
        .log { background: #f8f8f8; padding: 10px; margin: 10px 0; border-radius: 3px; font-family: monospace; white-space: pre-wrap; }
        .status { padding: 10px; margin: 10px 0; border-radius: 3px; }
        .status.success { background: #d4edda; border: 1px solid #c3e6cb; }
        .status.error { background: #f8d7da; border: 1px solid #f5c6cb; }
        .status.warning { background: #fff3cd; border: 1px solid #ffeaa7; }
    </style>
</head>
<body>
    <h1>Formspree Debug Tool</h1>
    
    <div class="info">
        <h3>当前配置</h3>
        <p><strong>端点:</strong> https://formspree.io/f/xldljvdb</p>
        <p><strong>目标邮箱:</strong> Ito.Takuya@meka-tech.com</p>
        <p><strong>状态:</strong> <span id="endpoint-status">检查中...</span></p>
    </div>

    <!-- 端点测试 -->
    <div class="test-section">
        <h3>1. 端点连接测试</h3>
        <button onclick="testEndpoint()">测试端点连接</button>
        <div id="endpoint-result" class="log"></div>
    </div>

    <!-- 直接表单测试 -->
    <div class="test-section">
        <h3>2. 直接表单提交测试</h3>
        <form action="https://formspree.io/f/xldljvdb" method="POST" target="_blank" id="direct-form">
            <div class="form-group">
                <label>测试名称:</label>
                <input type="text" name="name" value="Debug Test User" required>
            </div>
            <div class="form-group">
                <label>测试邮箱:</label>
                <input type="email" name="email" value="debug@test.com" required>
            </div>
            <div class="form-group">
                <label>测试消息:</label>
                <textarea name="message" rows="3" required>这是一个调试测试消息。时间: ${new Date().toLocaleString()}</textarea>
            </div>
            <div class="form-group">
                <label>测试类型:</label>
                <select name="test-type">
                    <option value="debug">调试测试</option>
                    <option value="connection">连接测试</option>
                    <option value="email">邮件测试</option>
                </select>
            </div>
            <button type="submit">提交直接表单</button>
        </form>
        <div class="info">
            <p><strong>说明:</strong> 点击提交后会在新窗口打开Formspree的响应页面。如果看到"Thanks"页面，说明端点工作正常。</p>
        </div>
    </div>

    <!-- JavaScript Fetch测试 -->
    <div class="test-section">
        <h3>3. JavaScript Fetch API测试</h3>
        <button onclick="testFetch()">测试Fetch API</button>
        <div id="fetch-result" class="log"></div>
    </div>

    <!-- 替代端点测试 -->
    <div class="test-section">
        <h3>4. 替代端点测试</h3>
        <p>尝试不同的端点格式：</p>
        <button onclick="testAlternativeEndpoints()">测试替代端点</button>
        <div id="alternative-result" class="log"></div>
    </div>

    <!-- 邮件配置检查 -->
    <div class="test-section">
        <h3>5. 邮件配置检查</h3>
        <div class="info">
            <h4>需要检查的Formspree设置：</h4>
            <ol>
                <li><strong>账户状态:</strong> 登录 https://formspree.io 检查账户是否激活</li>
                <li><strong>端点ID:</strong> 确认端点ID是否正确</li>
                <li><strong>邮件设置:</strong> 检查邮件转发设置</li>
                <li><strong>垃圾邮件:</strong> 检查垃圾邮件文件夹</li>
                <li><strong>邮件限制:</strong> 免费账户有每月100封限制</li>
            </ol>
        </div>
        <button onclick="checkFormspreeSettings()">打开Formspree设置</button>
    </div>

    <!-- 本地测试 -->
    <div class="test-section">
        <h3>6. 本地环境测试</h3>
        <div class="info">
            <p><strong>当前URL:</strong> <span id="current-url"></span></p>
            <p><strong>User Agent:</strong> <span id="user-agent"></span></p>
        </div>
        <button onclick="testLocalEnvironment()">测试本地环境</button>
        <div id="local-result" class="log"></div>
    </div>

    <script>
        // 显示当前环境信息
        document.getElementById('current-url').textContent = window.location.href;
        document.getElementById('user-agent').textContent = navigator.userAgent;

        // 测试端点连接
        async function testEndpoint() {
            const resultDiv = document.getElementById('endpoint-result');
            resultDiv.textContent = '测试中...';
            
            try {
                const response = await fetch('https://formspree.io/f/xldljvdb', {
                    method: 'HEAD'
                });
                
                if (response.ok) {
                    resultDiv.innerHTML = '✅ 端点可访问\n状态码: ' + response.status + '\n状态: ' + response.statusText;
                    document.getElementById('endpoint-status').innerHTML = '<span class="success">✅ 端点正常</span>';
                } else {
                    resultDiv.innerHTML = '❌ 端点错误\n状态码: ' + response.status + '\n状态: ' + response.statusText;
                    document.getElementById('endpoint-status').innerHTML = '<span class="error">❌ 端点错误</span>';
                }
            } catch (error) {
                resultDiv.innerHTML = '❌ 连接失败\n错误: ' + error.message;
                document.getElementById('endpoint-status').innerHTML = '<span class="error">❌ 连接失败</span>';
            }
        }

        // 测试Fetch API
        async function testFetch() {
            const resultDiv = document.getElementById('fetch-result');
            resultDiv.textContent = '测试中...';
            
            try {
                const formData = new FormData();
                formData.append('name', 'Fetch Test User');
                formData.append('email', 'fetch@test.com');
                formData.append('message', 'Fetch API test message - ' + new Date().toLocaleString());
                formData.append('test-type', 'fetch-api');
                
                const response = await fetch('https://formspree.io/f/xldljvdb', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    resultDiv.innerHTML = '✅ Fetch API成功!\n状态码: ' + response.status + '\n响应: ' + JSON.stringify(result, null, 2);
                } else {
                    resultDiv.innerHTML = '❌ Fetch API失败\n状态码: ' + response.status + '\n状态: ' + response.statusText;
                }
            } catch (error) {
                resultDiv.innerHTML = '❌ Fetch API错误\n错误: ' + error.message;
            }
        }

        // 测试替代端点
        async function testAlternativeEndpoints() {
            const resultDiv = document.getElementById('alternative-result');
            resultDiv.textContent = '测试替代端点...\n';
            
            const endpoints = [
                'https://formspree.io/f/xldljvdb',
                'https://formspree.io/f/xldljvdb/',
                'https://formspree.io/f/xldljvdb/thanks'
            ];
            
            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(endpoint, { method: 'HEAD' });
                    resultDiv.textContent += `${endpoint}: ${response.status} ${response.statusText}\n`;
                } catch (error) {
                    resultDiv.textContent += `${endpoint}: 错误 - ${error.message}\n`;
                }
            }
        }

        // 打开Formspree设置
        function checkFormspreeSettings() {
            window.open('https://formspree.io/forms/xldljvdb', '_blank');
        }

        // 测试本地环境
        function testLocalEnvironment() {
            const resultDiv = document.getElementById('local-result');
            resultDiv.textContent = '本地环境信息:\n';
            resultDiv.textContent += 'URL: ' + window.location.href + '\n';
            resultDiv.textContent += '协议: ' + window.location.protocol + '\n';
            resultDiv.textContent += '主机: ' + window.location.host + '\n';
            resultDiv.textContent += '路径: ' + window.location.pathname + '\n';
            resultDiv.textContent += 'User Agent: ' + navigator.userAgent + '\n';
            resultDiv.textContent += '在线状态: ' + navigator.onLine + '\n';
            resultDiv.textContent += 'Cookie启用: ' + navigator.cookieEnabled + '\n';
        }

        // 页面加载时自动测试端点
        document.addEventListener('DOMContentLoaded', function() {
            testEndpoint();
        });
    </script>
</body>
</html> 